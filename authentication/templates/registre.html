{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Profil</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex min-h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-lg min-h-screen flex flex-col">
        <a href="{% url 'home' %}" class="flex items-center justify-center p-6 border-b border-gray-300">
            <img src="{% static 'assets/logo.png' %}" alt="Logo" class="w-32 bg-gray-900 pb-1 px-1 rounded-md">
        </a>

        <nav class="mt-6 space-y-2 px-4 font-['Poppins'] font-medium">
            <a href="{% url 'dashboard' %}" class="flex items-center p-3 rounded-lg hover:bg-gray-600 hover:text-white {% if request.path == '/dashboard/' %}bg-[#E09351] text-white{% else %}text-gray-700{% endif %}">
                <img src="{% static 'assets/dashboard.svg' %}" class="w-6 h-6">
                <span class="ml-3">Dashboard</span>
            </a>
            <a href="{% url 'profile' %}" class="flex items-center p-3 rounded-lg bg-gray-200 text-gray-900">
                <img src="{% static 'assets/user.svg' %}" class="w-6 h-6">
                <span class="ml-3">Mon Profil</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-6 flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-lg">
            <h2 class="text-3xl font-semibold text-gray-900 mb-6 text-center">Modifier mon Profil</h2>

            {% if messages %}
                {% for message in messages %}
                    <div class="mb-4 px-4 py-2 text-white rounded-md {% if message.tags == 'success' %} bg-green-500 {% else %} bg-red-500 {% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}

            <form method="post" enctype="multipart/form-data" class="space-y-4">
                {% csrf_token %}

                <!-- Photo de profil avec prévisualisation -->
                <div class="text-center">
                    <img id="profilePreview" src="{{ user.photo_user.url|default:static 'assets/avatar.png' }}" alt="Profil" class="w-24 h-24 rounded-full mx-auto object-cover shadow-md">
                </div>
                <div>
                    <label for="photo_user" class="block text-gray-700 font-medium">Photo de profil</label>
                    <input type="file" name="photo_user" id="photoInput" class="w-full p-3 border rounded-lg shadow-sm">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="username" class="block text-gray-700 font-medium">Nom d'utilisateur</label>
                        <input type="text" name="username" value="{{ user.username }}" class="w-full p-3 border rounded-lg shadow-sm focus:ring focus:ring-blue-200">
                    </div>
                    <div>
                        <label for="email" class="block text-gray-700 font-medium">Email</label>
                        <input type="email" name="email" value="{{ user.email }}" class="w-full p-3 border rounded-lg shadow-sm focus:ring focus:ring-blue-200">
                    </div>
                </div>

                <button type="submit" class="w-full bg-[#E09351] text-white p-3 rounded-lg font-semibold shadow-xl hover:bg-gray-900 transition duration-500 ease-in-out transform hover:-translate-y-1 hover:scale-105">
                    Mettre à jour
                </button>
            </form>
        </div>
    </main>

    <script>
        document.getElementById('photoInput').addEventListener('change', function(event) {
            var reader = new FileReader();
            reader.onload = function() {
                document.getElementById('profilePreview').src = reader.result;
            }
            reader.readAsDataURL(event.target.files[0]);
        });
    </script>
</body>
</html>